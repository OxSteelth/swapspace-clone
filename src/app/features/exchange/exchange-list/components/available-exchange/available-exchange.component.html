<div class="c-container">
  <div class="progress-wrapper" *ngIf="isLoading$ | async">
    <div class="progress-text">Searching for the best offers...</div>
    <div class="progress-bar">
      <div class="progress"></div>
    </div>
  </div>
  <div class="c-tabs" *ngIf="!(isLoading$ | async)">
    <app-tabs [tabs]="sortOptions" (activeTabIndexChange)="onTabChange($event)"></app-tabs>
  </div>
  <ng-container *ngIf="availableExchanges$ | async as allExchange; else loadingSkeleton">
    <ul class="c-exchange-container">
      <li
        *ngFor="let exchange of allExchange"
        class="c-exchange-container__item app-card"
        [ngClass]="{
          'trusted-partner': true,
          'best-rate': false,
          fastest: false
        }"
      >
        <div class="c-exchange-container__content">
          <div class="c-exchange__name">
            <img
              [src]="'assets/exchange-icons/' + exchange.partner + '.svg'"
              class="c-exchange__icon"
            />
            {{ exchange.partner }}
          </div>
          <div>
            <span class="c-exchange__item-name">Rate</span>
            <span *ngIf="exchange.fixed === true">
              <svg
                data-v-48eb64e5=""
                width="10"
                height="16"
                viewBox="0 0 10 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                class="fixed-icon__icon"
              >
                <path
                  data-v-48eb64e5=""
                  d="M1.47481 6.65124C1.47481 5.69412 1.46701 4.76809 1.4787 3.84285C1.48338 3.48662 1.49352 3.12163 1.57069 2.77735C1.99087 0.896594 3.61856 -0.206359 5.58613 0.0327201C7.19978 0.228765 8.5102 1.80908 8.52033 3.57907C8.52579 4.58559 8.52111 5.59212 8.52111 6.65124C8.7768 6.65124 9.00599 6.64407 9.2344 6.65283C9.74344 6.67276 9.99679 6.93415 9.99757 7.45375C10.0007 10.0422 10.0007 12.6314 9.99757 15.2198C9.99679 15.7163 9.74344 15.9945 9.25934 15.9961C6.41556 16.0032 3.57178 16.0032 0.728003 15.9961C0.256378 15.9953 0.00458543 15.7291 0.00380589 15.2509C-0.00165093 12.6354 -0.000871382 10.0207 0.00380589 7.40513C0.00458543 6.93335 0.262615 6.67754 0.731121 6.65443C0.961866 6.64167 1.19417 6.65124 1.47481 6.65124ZM8.58659 8.09209C6.16845 8.09209 3.79551 8.09209 1.40932 8.09209C1.39685 8.18692 1.37736 8.26343 1.37736 8.34073C1.3758 10.3187 1.38204 12.2975 1.36957 14.2755C1.36723 14.5974 1.52782 14.5998 1.75778 14.5998C3.914 14.5951 6.06944 14.5974 8.22566 14.5958C8.33948 14.5958 8.45329 14.5823 8.58737 14.5743C8.58659 12.4059 8.58659 10.2629 8.58659 8.09209ZM7.13352 6.63928C7.13352 5.61124 7.1343 4.61906 7.13352 3.62688C7.13196 2.38447 6.20664 1.41141 5.01706 1.39707C3.82513 1.38272 2.85226 2.38048 2.84836 3.62529C2.84525 4.50032 2.84836 5.37615 2.84836 6.25118C2.84836 6.37709 2.84836 6.50301 2.84836 6.63849C4.29754 6.63928 5.68357 6.63928 7.13352 6.63928Z"
                  fill="white"
                ></path>
              </svg>
            </span>
            <span *ngIf="exchange.fixed === false">
              <svg
                data-v-68b0206a=""
                width="20"
                height="8"
                viewBox="0 0 20 8"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                class="icon-floating"
              >
                <path
                  data-v-68b0206a=""
                  d="M14.5419 8.00076C13.1739 8.00076 11.8069 7.36573 10.7653 6.09449L8.62364 3.48055C7.25281 1.80744 5.02184 1.80744 3.651 3.48055L1.55731 6.03591C1.20116 6.47059 0.62422 6.47059 0.267111 6.03591C-0.0890372 5.60123 -0.0890372 4.89589 0.267111 4.46121L2.3608 1.90585C4.44298 -0.635447 7.83167 -0.635447 9.91288 1.90585L12.0546 4.5198C13.4254 6.19291 15.6564 6.19291 17.0272 4.5198L18.4422 2.79279C18.7984 2.35811 19.3753 2.35811 19.7324 2.79279C20.0886 3.22747 20.0886 3.93163 19.7324 4.36748L18.3174 6.09449C17.2768 7.36573 15.9098 8.00076 14.5419 8.00076Z"
                  fill="white"
                ></path>
              </svg>
            </span>
            {{ exchange.toAmount }}
            <span class="c-exchange__item-currency">{{ exchange.toCurrency }}</span>
          </div>
          <div class="c-exchange__item-group">
            <div>
              <span class="c-exchange__item-name">ETA: </span>
              {{ exchange.duration.split('-')[0] }}-{{ exchange.duration.split('-')[1] }} min
            </div>
            <div class="c-exchange__item">
              <span class="c-exchange__item-name">KYC Risk: </span>
              <div class="c-exchange__item-risk">
                <tui-svg
                  src="tuiIconDisc"
                  class="c-status-disk"
                  [ngClass]="{
                    low: true,
                    medium: false,
                    high: false
                  }"
                ></tui-svg>
                High
              </div>
            </div>
          </div>
        </div>
        <div class="c-exchange-container__actions">
          <div class="c-chips" *ngLet="fastestPartner$ | async as fastestPartner">
            <!-- <div
              *ngIf="
                exchange.partner === fastestPartner.partner &&
                exchange.duration === fastestPartner.duration
              "
              class="app-chip app-chip__green"
            >
              Trusted Partner
            </div>
            <div *ngIf="false" class="app-chip app-chip__yellow-2">Giveaway</div> -->
          </div>
          <button class="app-button-outline" (click)="exchangeCurrency(exchange)">Exchange</button>
        </div>
      </li>
    </ul>
  </ng-container>
</div>

<ng-template #loadingSkeleton>
  <ul class="c-exchange-container">
    <li
      *ngFor="let exchange of skeletonArray"
      class="c-exchange-container__item app-card app-skeleton"
    ></li>
  </ul>
</ng-template>
